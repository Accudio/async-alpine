var c=(t,e)=>[...t.attributes].map(i=>i.name).filter(i=>{for(let s of e.alpine.attributes)if(i.startsWith(s))return!0;return!1}).filter(i=>i!==`${e.alpine.prefix}cloak`),l=(t,e)=>{for(let i of t.attributes)t.node.setAttribute(e.prefix+i,t.node.getAttribute(i)),t.node.removeAttribute(i)},d=(t,e)=>{for(let i of t.attributes)t.node.setAttribute(i,t.node.getAttribute(e.prefix+i)),t.node.removeAttribute(e.prefix+i)};var b=class{constructor(t,e,i){this.instance=e,this.status="unloaded",this.src=t.getAttribute(this.instance.config.src),this.strategy=t.getAttribute(this.instance.config.root)||this.instance.config.defaultStrategy,this.name=t.getAttribute(`${this.instance.config.alpine.prefix}data`).split("(")[0],this.id=t.id||this.instance.config.prefix+i,this.root={node:t,attributes:c(t,this.instance.config)},t.setAttribute(this.instance.config.id,this.id),this.children=[...t.querySelectorAll("*")].filter(s=>c(s,this.instance.config).length).filter(s=>!s.hasAttribute(this.instance.config.root)).filter(s=>s.closest(`[${this.instance.config.root}]`)===t).map(s=>({node:s,attributes:c(s,this.instance.config)}))}deactivate(){l(this.root,this.instance.config);for(let t of this.children)l(t,this.instance.config)}async download(t){this.status="loading";let e=await this.getModule();t.data(this.name,e),this.activate()}async getModule(){if(this.instance.cache[this.src])return this.instance.cache[this.src];let t=await import(this.src),e=t[this.name]||t.default||Object.values(t)[0]||!1;return this.instance.cache[this.src]=e,e}activate(){d(this.root,this.instance.config);for(let t of this.children)d(t,this.instance.config);this.root.node.removeAttribute(`${this.instance.config.prefix}cloak`);for(let t of this.children)t.node.removeAttribute(`${this.instance.config.prefix}cloak`);this.status="loaded"}};var A=t=>new Promise(e=>{window.addEventListener("async-alpine:load",i=>{i.detail.id===t.id&&t.status==="unloaded"&&e()})}),f=A;var v=()=>new Promise(t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,200)}),u=v;var w=(t,e)=>new Promise(i=>{let s=e.indexOf("("),o=e.slice(s),n=window.matchMedia(o);n.matches?i():n.addEventListener("change",i,{once:!0})}),h=w;var y=(t,e)=>new Promise(i=>{let s="0px 0px 0px 0px";if(e.indexOf("(")!==-1){let n=e.indexOf("(")+1;s=e.slice(n,-1)}let o=new IntersectionObserver(n=>{n[0].isIntersecting&&(o.disconnect(),i())},{rootMargin:s});o.observe(t.root.node)}),p=y;var j={prefix:"ax-",root:"ax-load",src:"ax-load-src",id:"ax-id",defaultStrategy:"immediate",alpine:{prefix:"x-",attributes:["x-",":","@"]}},m=j;var S=1,x=(t,e={})=>{let i=document.querySelectorAll(`[${m.root}]`);if(!i)return;let s={config:m,cache:{}};e.prefix&&(s.config.alpine.prefix=e.prefix,s.config.alpine.attributes.push(e.prefix));for(let o of i){let n=new b(o,s,S++);n.deactivate();let g=n.strategy.split("|").map(r=>r.trim()).filter(r=>r!=="immediate").filter(r=>r!=="eager");if(!g.length){n.download(t);continue}let a=[];for(let r of g){if(r==="idle"){a.push(u());continue}if(r.startsWith("visible")){a.push(p(n,r));continue}if(r.startsWith("media")){a.push(h(n,r));continue}r==="event"&&a.push(f(n))}Promise.all(a).then(()=>{n.download(t)})}};document.addEventListener("alpine:init",()=>{x(Alpine)});
