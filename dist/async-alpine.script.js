var c=(t,e)=>[...t.attributes].map(i=>i.name).filter(i=>{for(let n of e.alpine.attributes)if(i.startsWith(n))return!0;return!1}).filter(i=>i!==`${e.alpine.prefix}cloak`),l=(t,e)=>{for(let i of t.attributes)t.node.setAttribute(e.prefix+x(i),t.node.getAttribute(i)),t.node.removeAttribute(i)},d=(t,e)=>{for(let i of t.attributes){let n=x(i);t.node.setAttribute(n,t.node.getAttribute(e.prefix+n)),t.node.removeAttribute(e.prefix+n)}},x=t=>t.startsWith("@")?"x-on:"+t.slice(1):t;var b=class{constructor(t,e,i){this.instance=e,this.status="unloaded",this.src=t.getAttribute(this.instance.config.prefix+this.instance.config.src),this.strategy=t.getAttribute(this.instance.config.prefix+this.instance.config.root)||this.instance.config.defaultStrategy,this.name=t.getAttribute(`${this.instance.config.alpine.prefix}data`).split("(")[0],this.id=t.id||this.instance.config.prefix+i,this.root={node:t,attributes:c(t,this.instance.config)},t.setAttribute(this.instance.config.id+this.instance.config.id,this.id),this.children=[...t.querySelectorAll("*")].filter(n=>c(n,this.instance.config).length).filter(n=>!n.hasAttribute(this.instance.config.prefix+this.instance.config.root)).filter(n=>n.closest(`[${this.instance.config.prefix}${this.instance.config.root}]`)===t).map(n=>({node:n,attributes:c(n,this.instance.config)}))}deactivate(){l(this.root,this.instance.config);for(let t of this.children)l(t,this.instance.config)}async download(t){this.status="loading";let e=await this.getModule();t.data(this.name,e),this.activate()}async getModule(){if(this.instance.cache[this.src])return this.instance.cache[this.src];let t=await import(this.src),e=t[this.name]||t.default||Object.values(t)[0]||!1;return this.instance.cache[this.src]=e,e}activate(){d(this.root,this.instance.config);for(let t of this.children)d(t,this.instance.config);this.root.node.removeAttribute(`${this.instance.config.alpine.prefix}cloak`);for(let t of this.children)t.node.removeAttribute(`${this.instance.config.alpine.prefix}cloak`);this.status="loaded"}};var v=t=>new Promise(e=>{window.addEventListener("async-alpine:load",i=>{i.detail.id===t.id&&t.status==="unloaded"&&e()})}),u=v;var w=()=>new Promise(t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,200)}),h=w;var y=(t,e)=>new Promise(i=>{let n=e.indexOf("("),o=e.slice(n),s=window.matchMedia(o);s.matches?i():s.addEventListener("change",i,{once:!0})}),p=y;var j=(t,e)=>new Promise(i=>{let n="0px 0px 0px 0px";if(e.indexOf("(")!==-1){let s=e.indexOf("(")+1;n=e.slice(s,-1)}let o=new IntersectionObserver(s=>{s[0].isIntersecting&&(o.disconnect(),i())},{rootMargin:n});o.observe(t.root.node)}),m=j;var P={prefix:"ax-",root:"load",src:"load-src",id:"id",defaultStrategy:"immediate",alpine:{prefix:"x-",attributes:["x-",":","@"]}},f=P;var $=1,A=(t,e={})=>{let i={config:f,cache:{}};e.prefix&&(i.config.prefix=e.prefix),e.alpinePrefix&&(i.config.alpine.prefix=e.alpinePrefix,i.config.alpine.attributes.push(e.alpinePrefix));let n=document.querySelectorAll(`[${f.prefix}${f.root}]`);if(!!n)for(let o of n){let s=new b(o,i,$++);s.deactivate();let g=s.strategy.split("|").map(r=>r.trim()).filter(r=>r!=="immediate").filter(r=>r!=="eager");if(!g.length){s.download(t);continue}let a=[];for(let r of g){if(r==="idle"){a.push(h());continue}if(r.startsWith("visible")){a.push(m(s,r));continue}if(r.startsWith("media")){a.push(p(s,r));continue}r==="event"&&a.push(u(s))}Promise.all(a).then(()=>{s.download(t)})}};document.addEventListener("alpine:init",()=>{A(Alpine)});
