var c=(t,e)=>[...t.attributes].map(n=>n.name).filter(n=>{for(let s of e.alpine.attributes)if(n.startsWith(s))return!0;return!1}).filter(n=>n!==`${e.alpine.prefix}cloak`),d=(t,e)=>{for(let n of t.attributes)t.node.setAttribute(e.prefix+b(n),t.node.getAttribute(n)),t.node.removeAttribute(n)},l=(t,e)=>{for(let n of t.attributes){let s=b(n);t.node.setAttribute(s,t.node.getAttribute(e.prefix+s)),t.node.removeAttribute(e.prefix+s)}},b=t=>t.startsWith("@")?"x-on:"+t.slice(1):t;var x=class{constructor(t,e,n){this.instance=e,this.status="unloaded",this.src=t.getAttribute(this.instance.config.src),this.strategy=t.getAttribute(this.instance.config.root)||this.instance.config.defaultStrategy,this.name=t.getAttribute(`${this.instance.config.alpine.prefix}data`).split("(")[0],this.id=t.id||this.instance.config.prefix+n,this.root={node:t,attributes:c(t,this.instance.config)},t.setAttribute(this.instance.config.id,this.id),this.children=[...t.querySelectorAll("*")].filter(i=>c(i,this.instance.config).length).filter(i=>!i.hasAttribute(this.instance.config.root)).filter(i=>i.closest(`[${this.instance.config.root}]`)===t).map(i=>({node:i,attributes:c(i,this.instance.config)})),this.parents=[];let s=t;do{if(s=s.parentNode.closest(`[${this.instance.config.root}]`),!s)break;let i=e.components.find(r=>r.root.node===s);this.parents.push(i.id)}while(s)}deactivate(){d(this.root,this.instance.config);for(let t of this.children)d(t,this.instance.config)}async download(t){this.status="loading";let e=await this.getModule();t.data(this.name,e),this.activate()}async getModule(){if(this.instance.moduleCache[this.src])return this.instance.moduleCache[this.src];let t=await import(this.src),e=t[this.name]||t.default||Object.values(t)[0]||!1;return this.instance.moduleCache[this.src]=e,e}activate(){l(this.root,this.instance.config);for(let t of this.children)l(t,this.instance.config);this.root.node.removeAttribute(`${this.instance.config.prefix}cloak`);for(let t of this.children)t.node.removeAttribute(`${this.instance.config.prefix}cloak`);this.status="loaded",window.dispatchEvent(new CustomEvent("async-alpine:loaded",{detail:{id:this.id}}))}};var v=t=>new Promise(e=>{window.addEventListener("async-alpine:load",n=>{n.detail.id===t.id&&t.status==="unloaded"&&e()})}),f=v;var y=()=>new Promise(t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,200)}),u=y;var j=(t,e)=>new Promise(n=>{let s=e.indexOf("("),i=e.slice(s),r=window.matchMedia(i);r.matches?n():r.addEventListener("change",n,{once:!0})}),p=j;var C=(t,e)=>new Promise(n=>{window.addEventListener("async-alpine:loaded",s=>{s.detail.id===e&&t.status==="unloaded"&&n()})}),h=C;var E=(t,e)=>new Promise(n=>{let s="0px 0px 0px 0px";if(e.indexOf("(")!==-1){let r=e.indexOf("(")+1;s=e.slice(r,-1)}let i=new IntersectionObserver(r=>{r[0].isIntersecting&&(i.disconnect(),n())},{rootMargin:s});i.observe(t.root.node)}),m=E;var $={prefix:"ax-",root:"ax-load",src:"ax-load-src",id:"ax-id",defaultStrategy:"immediate",alpine:{prefix:"x-",attributes:["x-",":","@"]}},g=$;var k=1,A=(t,e={})=>{let n=document.querySelectorAll(`[${g.root}]`);if(!n)return;let s={config:g,components:[],moduleCache:{}};e.prefix&&(s.config.alpine.prefix=e.prefix,s.config.alpine.attributes.push(e.prefix));for(let i of n){let r=new x(i,s,k++);s.components.push(r)}for(let i of s.components){i.deactivate();let r=i.strategy.split("|").map(o=>o.trim()).filter(o=>o!=="immediate").filter(o=>o!=="eager");if(!r.length){i.download(t);continue}let a=[];for(let o of r){if(o==="idle"){a.push(u());continue}if(o.startsWith("visible")){a.push(m(i,o));continue}if(o.startsWith("media")){a.push(p(i,o));continue}if(o==="event"&&a.push(f(i)),o==="parents")for(let w of i.parents)a.push(h(i,w))}Promise.all(a).then(()=>{i.download(t)})}};document.addEventListener("alpine:init",()=>{A(Alpine)});
